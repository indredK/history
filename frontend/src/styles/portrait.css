/* 竖屏布局优化样式 */
/* Requirements: 6.1, 6.2, 6.3, 6.4, 6.5, 9.2 - 竖屏毛玻璃风格适配 */

/* 竖屏模式检测 */
@media (orientation: portrait) {
  /* 应用布局调整 */
  .app {
    flex-direction: column !important;
  }
  
  /* 侧边栏在竖屏模式下的优化 */
  .MuiDrawer-root {
    /* 移除固定定位相关样式，因为现在由AppLayout控制 */
    display: none !important; /* 隐藏原有的Drawer */
  }
  
  /* ============================================
     竖屏导航栏毛玻璃风格
     Requirements: 6.1, 6.2, 9.2
     ============================================ */
  .MuiDrawer-paper {
    /* 移除固定定位相关样式 */
    position: relative !important;
    bottom: auto !important;
    top: auto !important;
    left: auto !important;
    right: auto !important;
    width: 100% !important;
    height: 80px !important;
    transform: none !important;
    transition: none !important;
    border-radius: var(--glass-radius-xl, 20px) !important;
    /* 毛玻璃效果 */
    backdrop-filter: blur(var(--glass-nav-blur, 12px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-nav-blur, 12px)) !important;
    background: linear-gradient(135deg, rgba(18, 18, 18, var(--glass-nav-bg-opacity, 0.8)) 0%, rgba(30, 30, 30, var(--glass-nav-bg-opacity, 0.8)) 100%) !important;
    border: var(--glass-border-width, 0.5px) solid rgba(255, 61, 0, 0.2) !important;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3), var(--glass-nav-active-glow, 0 0 10px rgba(255, 255, 255, 0.15)) !important;
    z-index: auto !important;
    margin: 0 !important;
  }
  
  /* ============================================
     竖屏侧边栏内容毛玻璃风格
     Requirements: 6.2
     ============================================ */
  .sidebar-content {
    display: flex !important;
    flex-direction: row !important;
    justify-content: space-between !important;
    align-items: center !important;
    height: 100% !important;
    padding: 4px 8px !important;
    overflow: hidden !important;
    /* 毛玻璃内容区域 */
    background: transparent !important;
  }
  
  /* ============================================
     竖屏导航项目毛玻璃风格
     Requirements: 6.3, 6.4, 6.5
     ============================================ */
  .nav-item {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    flex: 1 !important;
    max-width: none !important;
    min-width: 0 !important;
    height: 60px !important;
    padding: 4px 2px !important;
    border-radius: var(--glass-radius-md, 10px) !important;
    transition: all var(--glass-duration-normal, 200ms) var(--glass-easing, cubic-bezier(0.4, 0, 0.2, 1)) !important;
    text-decoration: none !important;
    color: rgba(255, 255, 255, 0.7) !important;
    /* 毛玻璃效果 */
    backdrop-filter: blur(0px) !important;
    -webkit-backdrop-filter: blur(0px) !important;
    background-color: transparent !important;
  }
  
  /* 导航项目悬停状态 - 毛玻璃效果 */
  .nav-item:hover {
    backdrop-filter: blur(var(--glass-btn-secondary-blur, 6px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-btn-secondary-blur, 6px)) !important;
    background: linear-gradient(135deg, rgba(255, 61, 0, 0.6) 0%, rgba(255, 111, 61, 0.6) 100%) !important;
    color: white !important;
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 15px rgba(255, 61, 0, 0.4), var(--glass-shadow-glow, 0 0 12px rgba(255, 255, 255, 0.08)) !important;
  }
  
  /* 导航项目活动状态 - 增强毛玻璃效果 */
  .nav-item.active {
    backdrop-filter: blur(var(--glass-btn-primary-blur, 8px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-btn-primary-blur, 8px)) !important;
    background: linear-gradient(135deg, rgba(255, 61, 0, 0.85) 0%, rgba(255, 111, 61, 0.85) 100%) !important;
    color: white !important;
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 15px rgba(255, 61, 0, 0.5), var(--glass-nav-active-glow, 0 0 10px rgba(255, 255, 255, 0.15)) !important;
    border: var(--glass-border-width, 0.5px) solid rgba(255, 255, 255, 0.2) !important;
  }
  
  .nav-item .nav-icon {
    font-size: 18px !important;
    margin-bottom: 2px !important;
  }
  
  .nav-item .nav-label {
    font-size: 8px !important;
    font-weight: 500 !important;
    text-align: center !important;
    line-height: 1 !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    max-width: 100% !important;
  }
  
  /* 主内容区域调整 */
  main {
    padding-bottom: 0px !important;
    overflow: hidden !important;
  }
  
  /* 表格容器在竖屏模式下的优化 - 毛玻璃风格 */
  .MuiTableContainer-root {
    height: 100% !important;
    margin-bottom: 0 !important;
    /* 毛玻璃效果 */
    backdrop-filter: blur(var(--glass-table-container-blur, 8px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-table-container-blur, 8px)) !important;
    background-color: rgba(30, 30, 30, var(--glass-table-container-bg-opacity, 0.6)) !important;
    border: var(--glass-border-width, 0.5px) solid var(--glass-border-color, rgba(255, 255, 255, 0.15)) !important;
    border-radius: var(--glass-radius-md, 10px) !important;
  }
  
  /* 隐藏桌面版侧边栏切换按钮 */
  .sidebar-toggle-btn {
    display: none !important;
  }
  
  /* 功能面板在竖屏模式下隐藏或最小化 */
  .function-panel {
    display: none !important;
  }
  
  /* 页面标题优化 */
  .page-title {
    font-size: 1.2rem !important;
    margin-bottom: 8px !important;
    padding: 0 16px !important;
  }
  
  /* 内容区域内边距调整 */
  .content {
    padding: 8px !important;
  }
  
  /* 表格在竖屏模式下的特殊优化 */
  .MuiTable-root {
    font-size: 0.7rem !important;
  }
  
  .MuiTableCell-root {
    padding: 4px 6px !important;
    font-size: 0.65rem !important;
    line-height: 1.2 !important;
    /* 毛玻璃行背景 */
    background-color: rgba(30, 30, 30, var(--glass-table-row-bg-opacity, 0.4)) !important;
    transition: background-color var(--glass-duration-hover, 100ms) var(--glass-easing, cubic-bezier(0.4, 0, 0.2, 1)) !important;
  }
  
  .MuiTableHead-root .MuiTableCell-root {
    padding: 6px 8px !important;
    font-size: 0.6rem !important;
    font-weight: 600 !important;
    /* 毛玻璃表头 */
    backdrop-filter: blur(var(--glass-table-header-blur, 10px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-table-header-blur, 10px)) !important;
    background-color: rgba(30, 30, 30, var(--glass-table-header-bg-opacity, 0.75)) !important;
  }
  
  /* 朝代标题行优化 */
  .dynasty-header-row .MuiTableCell-root {
    padding: 8px 6px !important;
    font-size: 0.7rem !important;
  }
  
  /* 展开图标调整 */
  .expand-icon {
    font-size: 1rem !important;
  }
  
  /* 地图按钮优化 - 毛玻璃风格 */
  .map-icon-button {
    width: 20px !important;
    height: 20px !important;
    padding: 2px !important;
    backdrop-filter: blur(var(--glass-btn-icon-blur, 6px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-btn-icon-blur, 6px)) !important;
    background-color: rgba(30, 30, 30, var(--glass-btn-icon-bg-opacity, 0.5)) !important;
    border: var(--glass-border-width, 0.5px) solid var(--glass-border-color, rgba(255, 255, 255, 0.15)) !important;
    border-radius: var(--glass-radius-full, 9999px) !important;
  }
  
  .map-icon-button .MuiSvgIcon-root {
    font-size: 0.7rem !important;
  }
  
  /* 滚动指示器位置调整 */
  .scroll-indicator {
    bottom: 16px !important;
  }
  
  /* 加载状态优化 */
  .loading-container {
    height: 100% !important;
  }
  
  /* 错误状态优化 */
  .error-container {
    height: 100% !important;
    padding: 16px !important;
  }
}

/* 小屏竖屏设备特殊优化 - 毛玻璃风格 */
@media (orientation: portrait) and (max-width: 375px) {
  .MuiDrawer-paper {
    height: 70px !important;
    margin: 0 !important;
    /* 小屏毛玻璃优化 - 减少模糊以提升性能 */
    backdrop-filter: blur(8px) !important;
    -webkit-backdrop-filter: blur(8px) !important;
    background: linear-gradient(135deg, rgba(18, 18, 18, 0.85) 0%, rgba(30, 30, 30, 0.85) 100%) !important;
  }
  
  .nav-item {
    flex: 1 !important;
    min-width: 0 !important;
    max-width: none !important;
    height: 50px !important;
    padding: 4px 2px !important;
    border-radius: var(--glass-radius-sm, 6px) !important;
  }
  
  .nav-item:hover,
  .nav-item.active {
    backdrop-filter: blur(6px) !important;
    -webkit-backdrop-filter: blur(6px) !important;
  }
  
  .nav-item .nav-icon {
    font-size: 16px !important;
  }
  
  .nav-item .nav-label {
    font-size: 8px !important;
    max-width: 100% !important;
  }
  
  main {
    padding-bottom: 0px !important;
    overflow: hidden !important;
  }
  
  .MuiTableContainer-root {
    height: 100% !important;
    /* 小屏毛玻璃优化 */
    backdrop-filter: blur(6px) !important;
    -webkit-backdrop-filter: blur(6px) !important;
  }
  
  .scroll-indicator {
    bottom: 16px !important;
  }
}

/* 大屏竖屏设备（平板竖屏）优化 - 毛玻璃风格 */
@media (orientation: portrait) and (min-width: 768px) {
  .MuiDrawer-paper {
    height: 90px !important;
    margin: 0 !important;
    /* 平板毛玻璃效果 - 可以使用更强的模糊 */
    backdrop-filter: blur(var(--glass-nav-blur, 12px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-nav-blur, 12px)) !important;
    background: linear-gradient(135deg, rgba(18, 18, 18, var(--glass-nav-bg-opacity, 0.8)) 0%, rgba(30, 30, 30, var(--glass-nav-bg-opacity, 0.8)) 100%) !important;
    border-radius: var(--glass-radius-xl, 20px) !important;
  }
  
  .nav-item {
    flex: 1 !important;
    min-width: 0 !important;
    max-width: none !important;
    height: 70px !important;
    padding: 4px 2px !important;
    border-radius: var(--glass-radius-md, 10px) !important;
  }
  
  .nav-item:hover {
    backdrop-filter: blur(8px) !important;
    -webkit-backdrop-filter: blur(8px) !important;
    background: linear-gradient(135deg, rgba(255, 61, 0, 0.6) 0%, rgba(255, 111, 61, 0.6) 100%) !important;
  }
  
  .nav-item.active {
    backdrop-filter: blur(10px) !important;
    -webkit-backdrop-filter: blur(10px) !important;
    background: linear-gradient(135deg, rgba(255, 61, 0, 0.85) 0%, rgba(255, 111, 61, 0.85) 100%) !important;
    box-shadow: 0 4px 20px rgba(255, 61, 0, 0.5), var(--glass-nav-active-glow, 0 0 10px rgba(255, 255, 255, 0.15)) !important;
  }
  
  .nav-item .nav-icon {
    font-size: 22px !important;
    margin-bottom: 4px !important;
  }
  
  .nav-item .nav-label {
    font-size: 11px !important;
    max-width: 100% !important;
  }
  
  main {
    padding-bottom: 0px !important;
    overflow: hidden !important;
  }
  
  .MuiTableContainer-root {
    height: 100% !important;
    /* 平板毛玻璃效果 */
    backdrop-filter: blur(var(--glass-table-container-blur, 8px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-table-container-blur, 8px)) !important;
    background-color: rgba(30, 30, 30, var(--glass-table-container-bg-opacity, 0.6)) !important;
    border-radius: var(--glass-radius-lg, 14px) !important;
  }
  
  .MuiTable-root {
    font-size: 0.8rem !important;
  }
  
  .MuiTableCell-root {
    padding: 6px 8px !important;
    font-size: 0.75rem !important;
    background-color: rgba(30, 30, 30, var(--glass-table-row-bg-opacity, 0.4)) !important;
  }
  
  .MuiTableHead-root .MuiTableCell-root {
    padding: 8px 10px !important;
    font-size: 0.7rem !important;
    backdrop-filter: blur(var(--glass-table-header-blur, 10px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-table-header-blur, 10px)) !important;
    background-color: rgba(30, 30, 30, var(--glass-table-header-bg-opacity, 0.75)) !important;
  }
  
  .scroll-indicator {
    bottom: 16px !important;
  }
}

/* 竖屏模式下的动画优化 - 毛玻璃过渡 */
@media (orientation: portrait) {
  .nav-item {
    transition: all var(--glass-duration-normal, 200ms) var(--glass-easing, cubic-bezier(0.4, 0, 0.2, 1)) !important;
  }
  
  .nav-item:active {
    transform: translateY(-1px) scale(0.95) !important;
    /* 触摸反馈毛玻璃效果 */
    backdrop-filter: blur(var(--glass-btn-primary-blur, 8px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-btn-primary-blur, 8px)) !important;
    background: linear-gradient(135deg, rgba(255, 61, 0, 0.9) 0%, rgba(255, 111, 61, 0.9) 100%) !important;
  }
  
  /* 平滑的方向切换过渡 */
  .app,
  main,
  .MuiDrawer-root,
  .MuiDrawer-paper {
    transition: all var(--glass-duration-slow, 300ms) var(--glass-easing, cubic-bezier(0.4, 0, 0.2, 1)) !important;
  }
}

/* 竖屏模式下的可访问性优化 - 毛玻璃焦点状态 */
@media (orientation: portrait) {
  .nav-item:focus {
    outline: 2px solid #FF3D00 !important;
    outline-offset: 2px !important;
  }
  
  .nav-item:focus-visible {
    backdrop-filter: blur(var(--glass-btn-secondary-blur, 6px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-btn-secondary-blur, 6px)) !important;
    background: linear-gradient(135deg, rgba(255, 61, 0, 0.3) 0%, rgba(255, 111, 61, 0.3) 100%) !important;
    box-shadow: 0 0 0 3px rgba(255, 61, 0, 0.3), var(--glass-shadow-glow, 0 0 12px rgba(255, 255, 255, 0.08)) !important;
  }
}

/* 竖屏模式下的性能优化 - 毛玻璃性能 */
@media (orientation: portrait) {
  .MuiDrawer-paper,
  .nav-item,
  main {
    will-change: transform, opacity !important;
    -webkit-transform: translateZ(0) !important;
    transform: translateZ(0) !important;
    contain: layout style !important;
  }
  
  .sidebar-content {
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* 毛玻璃组件性能优化 */
  .MuiTableContainer-root,
  .MuiPaper-root {
    will-change: opacity !important;
    contain: layout style !important;
  }
}

/* 竖屏模式下的特殊状态 - 毛玻璃适配 */
@media (orientation: portrait) {
  /* 当键盘弹出时的适配 */
  @supports (-webkit-touch-callout: none) {
    .app {
      height: -webkit-fill-available !important;
    }
    
    main {
      overflow: hidden !important;
    }
  }
  
  /* 安全区域适配（刘海屏等）- 毛玻璃导航栏 */
  .MuiDrawer-paper {
    padding-bottom: env(safe-area-inset-bottom) !important;
    /* 确保毛玻璃效果延伸到安全区域 */
    backdrop-filter: blur(var(--glass-nav-blur, 12px)) !important;
    -webkit-backdrop-filter: blur(var(--glass-nav-blur, 12px)) !important;
  }
  
  main {
    padding-bottom: 0px !important;
  }
}

/* ============================================
   竖屏模式减少动画偏好支持
   ============================================ */
@media (orientation: portrait) and (prefers-reduced-motion: reduce) {
  .nav-item,
  .MuiDrawer-paper,
  .app,
  main {
    transition: none !important;
  }
  
  .nav-item:hover,
  .nav-item.active,
  .nav-item:active {
    transform: none !important;
  }
}

/* ============================================
   竖屏模式毛玻璃降级处理
   ============================================ */
@media (orientation: portrait) {
  @supports not (backdrop-filter: blur(1px)) {
    .MuiDrawer-paper {
      background: linear-gradient(135deg, rgba(18, 18, 18, 0.95) 0%, rgba(30, 30, 30, 0.95) 100%) !important;
    }
    
    .nav-item:hover,
    .nav-item.active {
      background: linear-gradient(135deg, rgba(255, 61, 0, 0.9) 0%, rgba(255, 111, 61, 0.9) 100%) !important;
    }
    
    .MuiTableContainer-root {
      background-color: rgba(30, 30, 30, 0.9) !important;
    }
    
    .MuiTableHead-root .MuiTableCell-root {
      background-color: rgba(30, 30, 30, 0.95) !important;
    }
  }
}